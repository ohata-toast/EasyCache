# バックアップ

**Database > EasyCache > コンソール利用ガイド > バックアップ**

障害の状況に備えてキャッシュを復旧できるよう、あらかじめ準備できます。必要な時はいつでもコンソールでバックアップを実行したり、定期的にバックアップが実行されるように設定したりできます。バックアップの実行中は、キャッシュのマスターノードのパフォーマンスが低下することがあります。サービスに影響を与えないよう、サービスの負荷が少ない時間帯にバックアップすることを推奨します。バックアップによるパフォーマンスの低下を望まない場合は、高可用性構成を使用することもできます。

!!! tip 「ポイント」
    Valkeyは、バックアップを実行する際に.rdbファイルを作成します。作成したバックアップを利用して復元するには、バックアップと互換性のあるエンジンバージョンのキャッシュを使用することを推奨します。

## バックアップの種類

バックアップは手動バックアップと自動バックアップを提供します。

### 手動バックアップ

コンソールで手動でバックアップを実行し、特定時点のキャッシュのデータを永久に保存できます。手動バックアップは自動バックアップとは異なり、明示的に削除しない限り、キャッシュが削除されても一緒に削除されません。
手動バックアップを作成する際には、バックアップ名を指定する必要があり、次のような制約事項があります。
* バックアップ名は、1～100文字の半角英数字と一部の記号(-, _, .)のみ入力でき、先頭の文字は半角英字のみ使用できます。

![backup1.PNG](https://static.toastoven.net/prod_easycache/25.09.27/backup1.PNG)
#### 手動バックアップの作成

❶ キャッシュリストからバックアップするキャッシュを選択した後、**バックアップ**をクリックして手動でバックアップを作成できます。
❷ バックアップリストで**バックアップ作成**をクリックし、バックアップするキャッシュを指定して手動でバックアップを作成できます。

### 自動バックアップ
手動でバックアップを実行する場合の他にも、復元作業に必要な場合、または予定された自動バックアップ設定に従って自動バックアップが実行されることがあります。

#### 自動バックアップの設定
キャッシュの作成及び修正時に、バックアップに適用される設定項目を指定できます。

![backup2.PNG](https://static.toastoven.net/prod_easycache/25.09.27/backup2.PNG)

##### 自動バックアップを許可
自動バックアップを許可しない場合、自動バックアップは実行されず、下記の自動バックアップ関連項目は設定できません。

##### バックアップ保管期間(日)
自動バックアップをバックアップストレージに保存する期間を設定します。最大730日まで保管でき、自動バックアップの保管期間が変更されると、保管期間を過ぎた自動バックアップファイルは直ちに削除されます。

##### 自動バックアップの再試行回数
バックアップ時のキャッシュ負荷や、その他様々な理由で自動バックアップが失敗した場合に、再試行するように設定できます。最大10回まで再試行できます。再試行回数が残っていても、自動バックアップ実行時間の設定によっては再試行しないことがあります。

##### 自動バックアップ時間予約
バックアップが自動的に実行される時間を設定できます。バックアップ開始時刻とバックアップウィンドウで構成されます。バックアップ実行時間は、重複しないように複数回設定できます。バックアップ開始時刻を基準に、バックアップウィンドウ内の任意の時点でバックアップを実行します。バックアップウィンドウは、バックアップの総実行時間とは関係ありません。バックアップにかかる時間はキャッシュのメモリ使用量に比例し、サービスの負荷によって異なります。バックアップが失敗した場合、バックアップウィンドウを超えていなければ、バックアップの再試行回数に応じてバックアップを再試行します。

!!! tip 「ポイント」
    前回のバックアップが完了していないなどの状況では、バックアップが実行されない場合があります。

## バックアップストレージ及び課金
全てのバックアップファイルは、内部バックアップストレージにアップロードして保存します。手動バックアップの場合、別途削除するまで永久に保存され、バックアップ容量に応じてバックアップストレージの課金が発生します。自動バックアップの場合、設定した保管期間だけ保存され、バックアップファイルの容量分が課金されます。バックアップファイルが保存された内部バックアップストレージには直接アクセスできず、バックアップファイルが必要な場合は、キャッシュのデータエクスポート機能を使用してNHN CloudのオブジェクトストレージにRDBファイルをエクスポートできます。

## 復元
バックアップを利用して、任意の時点にデータを復元できます。復元時に、既存のキャッシュに復元するか、新しいキャッシュを作成して復元するかを選択できます。バックアップを実行した元のキャッシュと同じエンジンバージョンのキャッシュに復元できます。外部のRDBファイルを利用して復元するには、同じリージョンのNHN CloudオブジェクトストレージにRDBファイルをアップロードした後、目的のキャッシュのデータインポート機能を使用できます。

!!! tip 「ポイント」
    復元するキャッシュのメモリまたはMax Memory(MB)値が「バックアップのバックアップメモリ容量」より小さいか、元のキャッシュパラメータグループと異なるパラメータグループを使用する場合、復元に失敗することがあります。